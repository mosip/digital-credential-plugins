package io.mosip.certify.mock.integration.mocks;

import com.android.identity.util.Timestamp;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;
import org.mockito.MockedStatic;

import java.time.Instant;
import java.util.HashMap;
import java.util.Map;

import static org.junit.Assert.assertEquals;
import static org.mockito.Mockito.mockStatic;

public class MdocGeneratorTest {
    @Test
    void shouldGenerateMdocDataSuccessfully() {
        Instant fixedInstant = Instant.parse("2024-10-18T10:00:00Z");
        Timestamp currentTime = Timestamp.ofEpochMilli(fixedInstant.toEpochMilli());
        try (MockedStatic<Instant> mockedInstant = mockStatic(Instant.class)) {
            mockedInstant.when(Instant::now).thenReturn(fixedInstant);
        }
        try (MockedStatic<Timestamp> mockedStatic = mockStatic(Timestamp.class)) {
            mockedStatic.when(Timestamp::now).thenReturn(currentTime);
        }
        Map<String, Object> data = new HashMap<>();
        data.put("family_name", "Agatha");
        data.put("given_name", "Joseph");
        data.put("birth_date", "1994-11-06");
        data.put("issuing_country", "IN");
        data.put("document_number", 1233);
        data.put("driving_privileges", new HashMap<>() {{
            put("vehicle_category_code", "A");
        }});

        String generatedMdoc = new MdocGenerator().generate(data, "did:jwk:eyJrdHkiOiJFQyIsInVzZSI6InNpZyIsImNydiI6IlAtMjU2Iiwia2lkIjoiZEp2UzIzOXkyQk5Jc3VJdzZ4dG12M0QtLVotbC1yaDlZZ1NQYmhhOGRVVSIsIngiOiI0eDJtTUFHRHRMV3drRUtCMExnUHBYYmZzbVQtZ2FFeVg4c2lkZlFJV2NZIiwieSI6IlBkeU5LVlhyU1piNENZUW1vSzZsWDdadXgwRElCY25oSjktX2E3WmxZdGMiLCJhbGciOiJFUzI1NiJ9", "MIGHAgEAMBMGByqGSM49AgEGCCqGSM49AwEHBG0wawIBAQQgJTrm0HdsW/UMVf/AUmGk/3mbCXHVPTXY0QALHoxFu++hRANCAATTY8nTU9mjftsdWCwTY1ScE6rNEG5Q/Tb9mSXbMGmogt/GauO9vrwYWMljZhsXqYaAwkpYTIQc656atXGxfqX7||LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUIzakNDQVlXZ0F3SUJBZ0lVU2VpWUJacHgrNlNyODMrSnNZcEtxZmN2c3pjd0NnWUlLb1pJemowRUF3SXcKWGpFTE1Ba0dBMVVFQmhNQ1NVNHhEakFNQmdOVkJBZ01CVWxPTFV0Qk1SSXdFQVlEVlFRSERBbENRVTVIUVV4UApVa1V4RFRBTEJnTlZCQW9NQkUxUFEwc3hEVEFMQmdOVkJBc01CRTFQUTBzeERUQUxCZ05WQkFNTUJFMVBRMHN3CkhoY05NalF4TURJeE1EVTFPVFF3V2hjTk1qVXhNREl4TURVMU9UUXdXakJlTVFzd0NRWURWUVFHRXdKSlRqRU8KTUF3R0ExVUVDQXdGU1U0dFMwRXhFakFRQmdOVkJBY01DVUpCVGtkQlRFOVNSVEVOTUFzR0ExVUVDZ3dFVFU5RApTekVOTUFzR0ExVUVDd3dFVFU5RFN6RU5NQXNHQTFVRUF3d0VUVTlEU3pCWk1CTUdCeXFHU000OUFnRUdDQ3FHClNNNDlBd0VIQTBJQUJOTmp5ZE5UMmFOKzJ4MVlMQk5qVkp3VHFzMFFibEQ5TnYyWkpkc3dhYWlDMzhacTQ3MisKdkJoWXlXTm1HeGVwaG9EQ1NsaE1oQnpybnBxMWNiRitwZnVqSVRBZk1CMEdBMVVkRGdRV0JCUmVtVHJ0bHNGNwpZRFNueGVZUFlMUXprNTI5aWpBS0JnZ3Foa2pPUFFRREFnTkhBREJFQWlBZmRqRld6aG9BNTZ6VHNUZEtsT1dMCko5emx1b2dkTlhhUVZLMXlPM3hvMHdJZ1V4YzN1U2RDVzd6NUtvampKbndSMTlvelduYWRPeGFZY3BKQ0htWkIKeTBVPQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==");

        Assertions.assertEquals("omdkb2NUeXBldW9yZy5pc28uMTgwMTMuNS4xLm1ETGxpc3N1ZXJTaWduZWSiamlzc3VlckF1dGiEQ6EBJqEYIVkB4jCCAd4wggGFoAMCAQICFEnomAWacfukq_N_ibGKSqn3L7M3MAoGCCqGSM49BAMCMF4xCzAJBgNVBAYTAklOMQ4wDAYDVQQIDAVJTi1LQTESMBAGA1UEBwwJQkFOR0FMT1JFMQ0wCwYDVQQKDARNT0NLMQ0wCwYDVQQLDARNT0NLMQ0wCwYDVQQDDARNT0NLMB4XDTI0MTAyMTA1NTk0MFoXDTI1MTAyMTA1NTk0MFowXjELMAkGA1UEBhMCSU4xDjAMBgNVBAgMBUlOLUtBMRIwEAYDVQQHDAlCQU5HQUxPUkUxDTALBgNVBAoMBE1PQ0sxDTALBgNVBAsMBE1PQ0sxDTALBgNVBAMMBE1PQ0swWTATBgcqhkjOPQIBBggqhkjOPQMBBwNCAATTY8nTU9mjftsdWCwTY1ScE6rNEG5Q_Tb9mSXbMGmogt_GauO9vrwYWMljZhsXqYaAwkpYTIQc656atXGxfqX7oyEwHzAdBgNVHQ4EFgQUXpk67ZbBe2A0p8XmD2C0M5OdvYowCgYIKoZIzj0EAwIDRwAwRAIgH3YxVs4aAOes07E3SpTliyfc5bqIHTV2kFStcjt8aNMCIFMXN7knQlu8-SqI4yZ8EdfaM1p2nTsWmHKSQh5mQctFWQJN2BhZAkimZ3ZlcnNpb25jMS4wb2RpZ2VzdEFsZ29yaXRobWdTSEEtMjU2Z2RvY1R5cGVxb3JnLmlzby4xODAxMy41LjFsdmFsdWVEaWdlc3RzoXFvcmcuaXNvLjE4MDEzLjUuMagCWCDrEQH6dpCWbGMnj4u5A6vx-3l5KMxUaCZpg87Ev4w4agZYIBpdJsG8gcWO-OxWp_zilzkwofZ83doOmfWSw3bYwG3_A1ggKdcqpPPo63sO2-k_SdZ6bDklaMbDbLOrt1gmHDjNmmQBWCAenxjpxXvc7rvS298yLIJmjEZzNxjJ86HjdDxqEqnHFwRYIF5mWRbb2KpQEvEAWU58evPmpeKhcopqjIQRgj3pjIq_AFggiUMXi5PUPcwsY-wsv6RUE_RIfLEBhwBV_1ItgtQlRSAHWCAW4jRyZXVbBIka_lXEjlrsOybp8iqvYx4gMGZiMiVnSgVYIDzyQ6jwo0a0KmXZcfkJcxyCgToP99qD3GOY-gtRymCkbWRldmljZUtleUluZm-haWRldmljZUtleaQBAiABIVgg4x2mMAGDtLWwkEKB0LgPpXbfsmT-gaEyX8sidfQIWcYiWCA93I0pVetJlvgJhCagrqVftm7HQMgFyeEn379rtmVi12x2YWxpZGl0eUluZm-jZnNpZ25lZMB0MjAyNC0xMC0yMVQwNjozMToxOFppdmFsaWRGcm9twHQyMDI0LTEwLTIxVDA2OjMxOjE4Wmp2YWxpZFVudGlswHQyMDI1LTEwLTIxVDA2OjMxOjE4WlhAfdjjN0XYD39pIwfjsD7fnKUZjnbq5As7FpLwyc1jEOms46Mw5DyuUT2TuHV1Oz9RzGNIPq6Y57lzdNQ766D0fGpuYW1lU3BhY2VzoXFvcmcuaXNvLjE4MDEzLjUuMYjYGFhqpGhkaWdlc3RJRAJmcmFuZG9tUG2FLLW-amGqmgxhF71nQ-dxZWxlbWVudElkZW50aWZpZXJqaXNzdWVfZGF0ZWxlbGVtZW50VmFsdWV4GzIwMjQtMTAtMjFUMDY6MzE6MTguMjk2ODk0WtgYWGukaGRpZ2VzdElEBmZyYW5kb21Q3JeFc5mOaF6IXLNh-GyXRnFlbGVtZW50SWRlbnRpZmllcmtleHBpcnlfZGF0ZWxlbGVtZW50VmFsdWV4GzIwMjUtMTAtMjFUMDY6MzE6MTguMjk2ODk0WtgYWMGkaGRpZ2VzdElEA2ZyYW5kb21QIL6_sBEAsnZUVxjDD0BsyHFlbGVtZW50SWRlbnRpZmllcnJkcml2aW5nX3ByaXZpbGVnZXNsZWxlbWVudFZhbHVleGp7aXNzdWVfZGF0ZT0yMDI0LTEwLTIxVDA2OjMxOjE4LjI5Njg5NFosIHZlaGljbGVfY2F0ZWdvcnlfY29kZT1BLCBleHBpcnlfZGF0ZT0yMDI1LTEwLTIxVDA2OjMxOjE4LjI5Njg5NFp92BhYV6RoZGlnZXN0SUQBZnJhbmRvbVDjoYj_8RBZ62-85iZV371vcWVsZW1lbnRJZGVudGlmaWVyb2RvY3VtZW50X251bWJlcmxlbGVtZW50VmFsdWVkMTIzM9gYWFWkaGRpZ2VzdElEBGZyYW5kb21Qg7iWcNbZ-b9S2D3u3Av2YnFlbGVtZW50SWRlbnRpZmllcm9pc3N1aW5nX2NvdW50cnlsZWxlbWVudFZhbHVlYklO2BhYWKRoZGlnZXN0SUQAZnJhbmRvbVAFg1zMFq1oLYxHiib0UCeYcWVsZW1lbnRJZGVudGlmaWVyamJpcnRoX2RhdGVsZWxlbWVudFZhbHVlajE5OTQtMTEtMDbYGFhUpGhkaWdlc3RJRAdmcmFuZG9tUElZm1bdU7M1GlcrQPJ_ctNxZWxlbWVudElkZW50aWZpZXJqZ2l2ZW5fbmFtZWxlbGVtZW50VmFsdWVmSm9zZXBo2BhYVaRoZGlnZXN0SUQFZnJhbmRvbVB_NHtdmXkWLPqVnSgypGGWcWVsZW1lbnRJZGVudGlmaWVya2ZhbWlseV9uYW1lbGVsZW1lbnRWYWx1ZWZBZ2F0aGE=", generatedMdoc);
    }
}
